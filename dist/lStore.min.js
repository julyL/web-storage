!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lStore=e()}(this,function(){"use strict";function t(e,n){if(Array.isArray(n))return n.reduce(function(t,e){return t&&t[e]?t[e]:void 0},e);if("string"==typeof n){var r,o=[];return n.split(".").forEach(function(t){(r=t.match(/([^\[\]]+)|(\[\d+\])/g))&&(r=r.map(function(t){return t.replace(/\[(\d+)\]/,"$1")}),[].push.apply(o,r))}),t(e,o)}}function e(t,e){return e&&parseInt(t)==t&&/^(([1-9]\d*)|0)$/.test(t)?new Array(parseInt(t)):{}}function n(t,r,o,i){if(Array.isArray(r)){for(var a,c,u=t,p=[],l=0,_=r.length;l<=_-1;l++)a=r[l],"object"==(void 0===u?"undefined":s(u))&&null!=u?(p.push(u),c=u[a],l==_-1?u[a]=o:c&&"object"==(void 0===c?"undefined":s(c))||(u[a]=e(r[l+1],i))):(u=e(a,i),p.push(u),u[a]=l==_-1?o:e(r[l+1],i)),u=u[a];return p[0]}if("string"==typeof r){var f,d=[];return r.split(".").forEach(function(t){(f=t.match(/([^\[\]]+)|(\[\d+\])/g))&&(f=f.map(function(t){return t.replace(/\[(\d+)\]/,"$1")}),[].push.apply(d,f))}),n(t,d,o,i)}}function r(t,e){for(var n in e)t[n]=e[n];return t}function o(t){return"object"===(void 0===t?"undefined":s(t))&&"__start__"in t&&"__end__"in t&&"__data__"in t}function i(t,e){var n,i,a,s=[].slice.call(arguments,2);if(n=t.apply(this,s),this.opts.debug){i=r({},window[this.opts.storage]);for(var c in i)i.hasOwnProperty(c)&&(o(a=this.opts.deserialize(i[c]))?i[c]={__start:new Date(a.__start__).toUTCString(),__end__:new Date(a.__end__).toUTCString(),__data__:a.__data__}:delete i[c]);console.log(e+"("+(s[0]?'"'+s[0]+'"':"")+(s[1]?", "+this.opts.serialize(s[1]):"")+(s[2]?", "+JSON.stringify(s[2]):"")+")","\n   =>  ",i)}return n}function a(t,e,r){var i=this.opts;r&&r.exp&&(i.exp=r.exp);var a=window[i.storage],s=(t=i.namespace?"__namespace__"+i.namespace+"."+t:t).split(".")[0].split("[")[0],c=i.deserialize(a[s]),u=+new Date,p=u+1e3*i.exp;o(c)||(c={__start__:void 0,__data__:void 0,__end__:void 0}),window[i.storage].setItem(s,i.serialize({__start__:u,__end__:p,__data__:n(c.__data__,t,e,i.parseToArray)}))}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=(function(){function t(t){this.value=t}function e(e){function n(o,i){try{var a=e[o](i),s=a.value;s instanceof t?Promise.resolve(s.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(a.done?"return":"normal",a.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(t,e){return new Promise(function(r,a){var s={key:t,arg:e,resolve:r,reject:a,next:null};i?i=i.next=s:(o=i=s,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function t(e){var n={namespace:"",debug:!1,storage:"localStorage",exp:31536e6,serialize:function(t){return JSON.stringify(t)},deserialize:function(t){return t&&JSON.parse(t)},parseToArray:!0};if(!(this instanceof t))throw new TypeError("Store should be used as Failed to construct 'lStore': Please use the 'new' operator, this object constructor cannot be called as a function.");this.opts=r(n,e)});return c.prototype={constructor:c,get:function(){return i.call.apply(i,[this,function(e){var n=window[this.opts.storage],r=e,i=(e=this.opts.namespace?"__namespace__"+this.opts.namespace+"."+e:e).split(".")[0].split("[")[0],a=this.opts.deserialize(n[i]);if(o(a)){if(!(+new Date>=a.__end__))return t(a.__data__,e);this.remove(this.opts.namespace?r:i)}},"get"].concat(Array.prototype.slice.call(arguments)))},set:function(){return i.call.apply(i,[this,a,"set"].concat(Array.prototype.slice.call(arguments)))},remove:function(){return i.call.apply(i,[this,function(t){this.opts.namespace?a.call(this,t,""):window[this.opts.storage].removeItem(t)},"remove"].concat(Array.prototype.slice.call(arguments)))},clearAllExpires:function(){return i.call.apply(i,[this,function(){var t,e=window[this.opts.storage],n=+new Date;for(var r in e)e.hasOwnProperty(r)&&o(t=this.opts.deserialize(e[r]))&&n>=t.__end__&&window[this.opts.storage].removeItem(r)},"clearAllExpires"].concat(Array.prototype.slice.call(arguments)))},isSupported:function(){return function(t){var e=!1;if(t&&t.setItem){e=!0;var n="__"+Math.round(1e7*Math.random());try{t.setItem(n,n),t.removeItem(n)}catch(t){e=!1}}return e}(window[this.opts.storage])}},c});
